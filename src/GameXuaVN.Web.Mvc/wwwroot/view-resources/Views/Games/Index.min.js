(function(n){function o(n,r){abp.message.confirm(abp.utils.formatString(t("AreYouSureWantToDelete"),r),null,r=>{r&&f.delete({id:n}).done(()=>{abp.notify.info(t("SuccessfullyDeleted")),i.ajax.reload()})})}var f=abp.services.app.game,t=abp.localization.getSource("GameXuaVN"),r=n("#GameCreateModal"),u=r.find("form"),e=n("#GamesTable"),i;create=function(t,i){var r=new FormData,u,f,e;for(u in t)t.hasOwnProperty(u)&&r.append(u,t[u]);return f=n('input[name="ThumbnailFromFile"]')[0].files[0],f&&r.append("ThumbnailFromFile",f),e=n('input[name="DataFromFile"]')[0].files[0],e&&r.append("DataFromFile",e),abp.ajax(n.extend(!0,{url:abp.appPath+"Game/Create",type:"POST",processData:!1,contentType:!1,data:r},i))};i=e.DataTable({paging:!0,serverSide:!0,listAction:{ajaxFunction:f.getAll,inputFilter:function(){return n("#GamesSearchForm").serializeFormToObject(!0)}},buttons:[{name:"refresh",text:'<i class="fas fa-redo-alt"><\/i>',action:()=>i.draw(!1)}],responsive:{details:{type:"column"}},columnDefs:[{targets:0,className:"control",defaultContent:""},{targets:1,data:"name",sortable:!1},{targets:2,data:"description",sortable:!1},{targets:3,data:"totalPlay",sortable:!1},{targets:4,data:"totalLike",sortable:!1,render:(n,t,i)=>`${i.totalLike} / ${i.totalDislike}`},{targets:5,data:"thumnail",sortable:!1,render:(n,t,i)=>`<img src="${i.thumbnailBase64}"  style="width:133px; height:80px;" />`},{targets:6,data:null,sortable:!1,width:300,defaultContent:"",render:(n,i,r)=>[`   <button type="button" class="btn btn-sm bg-secondary edit-game" data-game-id="${r.id}" data-toggle="modal" data-target="#GameEditModal">`,`       <i class="fas fa-pencil-alt"></i> ${t("Edit")}`,"   <\/button>",`   <button type="button" class="btn btn-sm bg-success edit-game" data-game-id="${r.id}" data-toggle="modal" data-target="#GameEditModal">`,`       <i class="fas fa-play"></i> ${t("Test")}`,"   <\/button>",`   <button type="button" class="btn btn-sm bg-primary edit-game" data-game-id="${r.id}" data-toggle="modal" data-target="#GameEditModal">`,`       <i class="fas fa-download"></i> ${t("Download")}`,"   <\/button>",`   <button type="button" class="btn btn-sm bg-danger delete-game" data-game-id="${r.id}" data-game-name="${r.name}">`,`       <i class="fas fa-trash"></i> ${t("Delete")}`,"   <\/button>"].join("")}]});u.validate({rules:{Password:"required",ConfirmPassword:{equalTo:"#Password"}}});u.find(".save-button").on("click",n=>{if(n.preventDefault(),u.valid()){var f=u.serializeFormToObject();f.Page=f.Name.substring(0,1);abp.ui.setBusy(r);create(f).done(function(){r.modal("hide");u[0].reset();abp.notify.info(t("SavedSuccessfully"));i.ajax.reload()}).always(function(){abp.ui.clearBusy(r)})}});n(document).on("click",".delete-game",function(){var t=n(this).attr("data-game-id"),i=n(this).attr("data-game-name");o(t,i)});n(document).on("click",".edit-game",function(t){var i=n(this).attr("data-game-id");t.preventDefault();abp.ajax({url:abp.appPath+"Game/EditModal?gameId="+i,type:"POST",dataType:"html",success:function(t){n("#GameEditModal div.modal-content").html(t)},error:function(){}})});n(document).on("click",'a[data-target="#GameCreateModal"]',()=>{n('.nav-tabs a[href="#game-details"]').tab("show")});abp.event.on("game.edited",()=>{i.ajax.reload()});r.on("shown.bs.modal",()=>{r.find("input:not([type=hidden]):first").focus()}).on("hidden.bs.modal",()=>{u.clearForm()});n(".btn-search").on("click",()=>{i.ajax.reload()});n(".txt-search").on("keypress",n=>{if(n.which==13)return i.ajax.reload(),!1})})(jQuery);