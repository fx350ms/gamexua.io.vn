(function(n){function o(n,t){abp.message.confirm(abp.utils.formatString(i("AreYouSureWantToDelete"),t),null,t=>{t&&f.delete({id:n}).done(()=>{abp.notify.info(i("SuccessfullyDeleted")),u.ajax.reload()})})}var f=abp.services.app.file,i=abp.localization.getSource("GameXuaVN"),r=n("#FileCreateModal"),t=r.find("form"),e=n("#FilesTable"),u=e.DataTable({paging:!0,serverSide:!0,listAction:{ajaxFunction:f.getAll,inputFilter:function(){return n("#FilesSearchForm").serializeFormToObject(!0)}},buttons:[{name:"refresh",text:'<i class="fas fa-redo-alt"><\/i>',action:()=>u.draw(!1)}],responsive:{details:{type:"column"}},columnDefs:[{targets:0,className:"control",defaultContent:""},{targets:1,data:"fileName",sortable:!1},{targets:2,data:"description",sortable:!1},{targets:3,data:"downloadCount",sortable:!1},{targets:4,data:"totalRate",sortable:!1},{targets:5,data:"Thumbnail",sortable:!1,render:()=>`<img alt="photo" />`},{targets:6,data:null,sortable:!1,width:300,defaultContent:"",render:(n,t,r)=>[`   <button type="button" class="btn btn-sm bg-secondary edit-file" data-file-id="${r.id}" data-toggle="modal" data-target="#FileEditModal">`,`       <i class="fas fa-pencil-alt"></i> ${i("Edit")}`,"   <\/button>",`   <button type="button" class="btn btn-sm bg-primary edit-file" data-file-id="${r.id}" data-toggle="modal" data-target="#FileEditModal">`,`       <i class="fas fa-download"></i> ${i("Download")}`,"   <\/button>",`   <button type="button" class="btn btn-sm bg-danger delete-file" data-file-id="${r.id}" data-file-name="${r.name}">`,`       <i class="fas fa-trash"></i> ${i("Delete")}`,"   <\/button>"].join("")}]});t.validate({rules:{Password:"required",ConfirmPassword:{equalTo:"#Password"}}});t.find(".save-button").on("click",e=>{var o,s,h,c;if(e.preventDefault(),t.valid()){if(o=t.serializeFormToObject(),o.roleNames=[],s=t[0].querySelectorAll("input[name='role']:checked"),s)for(h=0;h<s.length;h++)c=n(s[h]),o.roleNames.push(c.val());abp.ui.setBusy(r);f.create(o).done(function(){r.modal("hide");t[0].reset();abp.notify.info(i("SavedSuccessfully"));u.ajax.reload()}).always(function(){abp.ui.clearBusy(r)})}});n(document).on("click",".delete-file",function(){var t=n(this).attr("data-file-id"),i=n(this).attr("data-file-name");o(t,i)});n(document).on("click",".edit-file",function(t){var i=n(this).attr("data-file-id");t.preventDefault();abp.ajax({url:abp.appPath+"Files/EditModal?fileId="+i,type:"POST",dataType:"html",success:function(t){n("#FileEditModal div.modal-content").html(t)},error:function(){}})});n(document).on("click",'a[data-target="#FileCreateModal"]',()=>{n('.nav-tabs a[href="#file-details"]').tab("show")});abp.event.on("file.edited",()=>{u.ajax.reload()});r.on("shown.bs.modal",()=>{r.find("input:not([type=hidden]):first").focus()}).on("hidden.bs.modal",()=>{t.clearForm()});n(".btn-search").on("click",()=>{u.ajax.reload()});n(".txt-search").on("keypress",n=>{if(n.which==13)return u.ajax.reload(),!1})})(jQuery);